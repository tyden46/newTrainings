<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Introducción R, manipulación y visualización en R</title>
  <meta name="description" content="Introducción R, manipulación y visualización en R" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Introducción R, manipulación y visualización en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://www.castrolab.org" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introducción R, manipulación y visualización en R" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="http://www.castrolab.org/isme/introR/introR.html">Introducción a R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="0.1" data-path=""><a href="#workshop"><i class="fa fa-check"></i><b>0.1</b> Acerca del curso</a></li>
<li class="chapter" data-level="1" data-path=""><a href="#introR"><i class="fa fa-check"></i><b>1</b> Introducción a R</a><ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#por-que-r"><i class="fa fa-check"></i><b>1.1</b> ¿Por qué R?</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#conociendo-rstudio"><i class="fa fa-check"></i><b>1.2</b> Conociendo RStudio</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#set-de-datos-para-trabajar"><i class="fa fa-check"></i><b>1.3</b> Set de datos para trabajar</a></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#extraer-informacion-de-tablas"><i class="fa fa-check"></i><b>1.4</b> Extraer información de tablas</a></li>
<li class="chapter" data-level="1.5" data-path=""><a href="#factores"><i class="fa fa-check"></i><b>1.5</b> Factores</a><ul>
<li class="chapter" data-level="1.5.1" data-path=""><a href="#transformar-factores"><i class="fa fa-check"></i><b>1.5.1</b> Transformar factores</a></li>
<li class="chapter" data-level="1.5.2" data-path=""><a href="#renombrar-factores"><i class="fa fa-check"></i><b>1.5.2</b> Renombrar factores</a></li>
<li class="chapter" data-level="1.5.3" data-path=""><a href="#argumento-stringsasfactors"><i class="fa fa-check"></i><b>1.5.3</b> Argumento <code>stringsAsFactors</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path=""><a href="#manipulacion-de-datos-en-r"><i class="fa fa-check"></i><b>2</b> Manipulación de datos en R</a><ul>
<li class="chapter" data-level="2.1" data-path=""><a href="#seleccionar-columnas-y-filtrar-filas"><i class="fa fa-check"></i><b>2.1</b> Seleccionar columnas y filtrar filas</a></li>
<li class="chapter" data-level="2.2" data-path=""><a href="#funciones-anidadas-y-pipes"><i class="fa fa-check"></i><b>2.2</b> Funciones anidadas y <strong><em>pipes</em></strong></a></li>
<li class="chapter" data-level="2.3" data-path=""><a href="#mutate-crear-nuevas-columnas-desde-informacion-existente-en-otras-columnas"><i class="fa fa-check"></i><b>2.3</b> <strong><em>Mutate</em></strong>: crear nuevas columnas desde información existente en otras columnas</a></li>
<li class="chapter" data-level="2.4" data-path=""><a href="#dividir---aplicar---combinar"><i class="fa fa-check"></i><b>2.4</b> Dividir -&gt; aplicar -&gt; combinar</a></li>
<li class="chapter" data-level="2.5" data-path=""><a href="#contar"><i class="fa fa-check"></i><b>2.5</b> Contar</a></li>
<li class="chapter" data-level="2.6" data-path=""><a href="#remodelar-tablas-usando-spread-y-gather"><i class="fa fa-check"></i><b>2.6</b> Remodelar tablas usando <code>spread()</code> y <code>gather()</code></a></li>
<li class="chapter" data-level="2.7" data-path=""><a href="#exportar-datos"><i class="fa fa-check"></i><b>2.7</b> Exportar datos</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path=""><a href="#visualizacion-de-datos-en-r"><i class="fa fa-check"></i><b>3</b> Visualización de datos en R</a><ul>
<li class="chapter" data-level="3.1" data-path=""><a href="#graficar-con-ggplot2"><i class="fa fa-check"></i><b>3.1</b> Graficar con <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.2" data-path=""><a href="#construyendo-graficos-iterativamente"><i class="fa fa-check"></i><b>3.2</b> Construyendo gráficos iterativamente</a></li>
<li class="chapter" data-level="3.3" data-path=""><a href="#boxplot"><i class="fa fa-check"></i><b>3.3</b> Boxplot</a></li>
<li class="chapter" data-level="3.4" data-path=""><a href="#graficar-datos-con-series-de-tiempo"><i class="fa fa-check"></i><b>3.4</b> Graficar datos con series de tiempo</a></li>
<li class="chapter" data-level="3.5" data-path=""><a href="#faceting"><i class="fa fa-check"></i><b>3.5</b> <em>Faceting</em></a></li>
<li class="chapter" data-level="3.6" data-path=""><a href="#ggplot2-themes"><i class="fa fa-check"></i><b>3.6</b> <code>ggplot2</code> <em>themes</em></a></li>
<li class="chapter" data-level="3.7" data-path=""><a href="#personalizacion"><i class="fa fa-check"></i><b>3.7</b> Personalización</a></li>
<li class="chapter" data-level="3.8" data-path=""><a href="#organizar-y-exportar-graficos"><i class="fa fa-check"></i><b>3.8</b> Organizar y exportar gráficos</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="http://www.castrolab.org">CASTRO LAB</a></li>
<li><a href="https://isme-la2019.org">ISME LA 2019</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introducción R, manipulación y visualización en R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Introducción R, manipulación y visualización en R</h1>
<p class="date"><em>ISME Latin America, Septiembre 2019</em></p>
</div>
<!-- Load the required packages -->
<!-- Set knitr basics and load sessions basics -->
<div id="workshop" class="section level2">
<h2><span class="header-section-number">0.1</span> Acerca del curso</h2>
<p>El tutorial a continuación fue creado especialmente para guiar el trabajo práctico del <a href="https://isme-la2019.org/curso-pre-congreso/"><strong>curso pre-congreso ISME Latin America 2019</strong></a>: <strong>Análisis de datos bioinformáticos para metagenomas y amplicones usando R</strong>. A realizarse el próximo 9 y 10 de septiembre en la <a href="https://www.usm.cl">Universidad Técnica Federico Santa María</a>, Valparaíso, Chile.</p>
<p><img src="images/back.png" /> <a href="http://castrolab.org/isme/bienvenida_WorkshopISME.html"><strong>Ir a la página de inicio del curso</strong></a></p>
<p>El curso cuenta con <strong>6 unidades</strong>. Ahora, usted se encuentra en la unidad: <strong>Introducción a R: Manipulación de datos y visualización</strong> <img src="images/r.png" /></p>
<blockquote>
<p><strong>Otras unidades del curso son</strong>:</p>
<p><a href="http://www.castrolab.org/isme/dada2/dada2.html"><strong>Análisis de secuencias de 16S con DADA2</strong></a> <img src="images/bioinformatics.png" /></p>
<p><a href="http://www.castrolab.org/isme/biodiversity/biodiversity.html"><strong>Introducción a phyloseq y a análisis de diversidad</strong></a> <img src="images/bacteria.png" /></p>
<p><a href="http://www.castrolab.org/isme/gene_search/gene_search.html"><strong>Búsqueda de genes de interés en datos de metagenómica <em>shotgun</em></strong></a> <img src="images/gene_search.png" /></p>
<p><a href="http://www.castrolab.org/isme/mags/mags.html"><strong>Visualización y curación de genomas ensamblados desde metagenomas (MAGs)</strong></a> <img src="images/genome.png" /></p>
<p><a href="http://www.castrolab.org/isme/microbial_networks/microbial_networks.html"><strong>Redes de co-ocurrencia de microorganismos</strong></a> <img src="images/network.png" /></p>
</blockquote>
<hr />
<ul>
<li><p>Profesor: <strong>Dr. Eduardo Castro-Nallar</strong> (<a href="mailto:eduardo.castro@unab.cl">eduardo.castro@unab.cl</a>)</p></li>
<li>Ayudantes:
<ul>
<li><strong>Dr. Florence Gutzwiller</strong> (<a href="mailto:florence.gutzwiller@gmail.com">florence.gutzwiller@gmail.com</a>)</li>
<li><strong>M.Sc. Katterinne N. Mendez</strong> (<a href="mailto:mendez.katterinne@gmail.com">mendez.katterinne@gmail.com</a>)</li>
</ul></li>
</ul>
<center>
<p><strong><a href="http://www.castrolab.org">CASTRO LAB</a></strong></p>
<p><a href="http://www.cbib.cl">Centro de Bioinformática y Biología Integrativa</a> | <a href="https://www.unab.cl">Universidad Andrés Bello</a></p>
<p><img src="images/UNAB_CBIB_horizontal.png" width="650"></p>
<a href="https://goo.gl/maps/BCe9hWcRZJKkhaDP8">Santiago, Chile</a>
</center>
</div>
<div id="introR" class="section level1">
<h1><span class="header-section-number">1</span> Introducción a R</h1>
<div id="por-que-r" class="section level2">
<h2><span class="header-section-number">1.1</span> ¿Por qué R?</h2>
<p>Tus análisis serán una serie de <strong>comandos</strong> escritos (R <em>script</em>), lo que es muy conveniente porque:</p>
<ul>
<li>Conlleva a tener el control y completo entendimiento de qué estás haciendo (<strong>adiós a la caja negra</strong> en tus análisis <em>in silico</em>).</li>
<li>¡<strong>Reproducibilidad</strong>! Si necesitas repetir el análisis, agregar más datos o corregir un error, sólo necesitas correr tu <em>script</em> nuevamente y tus tests estadísticos y gráficos se actualizarán automáticamente.</li>
<li>Tus análisis son claros y transparentes, cualquier colega o tú en el futuro pueden leerlo para encontrar errores y/o hacer mejoras.</li>
<li>Puedes <strong>comentar tu <em>script</em></strong>. Agregar comentarios, explicaciones o relatos en tu código facilitará entender, paso a paso, el por qué de tus análisis a tus colegas, e incluso a ti mísmo en el futuro.</li>
</ul>
<p>Otras importantes ventajas de usar R son:</p>
<ul>
<li>¡<strong>Escalabilidad</strong>! R está diseñado para el análisis de datos. Las habilidades que vayas aprendiendo en R se pueden escalar fácilmente con el tamaño de tus datos (set de datos con cientos a miles, incluso millones de líneas).</li>
<li>¡<strong>Gráficos de alta calidad</strong>! R tiene innumerables funcionalidades para todo tipo de gráficas a tu disposición para lograr una efectiva visualización de tus resultados. Visita <strong><a href="http://www.r-graph-gallery.com/all-graphs/">The R Graph Gallery</a></strong> para ver ejemplos de lo que puedes llegar a hacer.</li>
<li>¡<strong>Amplia documentación</strong>! R cuenta con una basta documentación y la web está minada de tutoriales, sólo debes buscar. Por ejemplo, <strong><a href="http://www.cookbook-r.com">Cookbook for R</a></strong> que provee de soluciones a tareas y problemas básicos en análisis de datos.</li>
</ul>
<p>Aprender R puede ser difícil y tomar tiempo en un principio, pero ¡no te preocupes, no estás sólo! R cuenta con una amplia comunidad de usuarios dispuestos a ayudar a través de <em>mailing-lists</em> y <em>websites</em> como <a href="https://stackoverflow.com/">Stack Overflow</a> y <a href="https://community.rstudio.com/">RStudio community</a>. Sin embargo, lo más probable es que tus dudas ya se encuentren resueltas en la web, asi que primero haz una búsqueda en <strong><a href="https://www.google.com">Google</a></strong> usando palabras clave o <strong>copia y pega en el buscador el mensaje de error</strong> que te aparezca en la consola de R. <strong>Consejo</strong>: haz tus búsquedas y consultas en inglés, tendrás acceso a más y mejor información.</p>
</div>
<div id="conociendo-rstudio" class="section level2">
<h2><span class="header-section-number">1.2</span> Conociendo RStudio</h2>
<p>¡Todo lo que necesitas en una ventana! Como puedes ver en la imagen a continuación, RStudio se divide en 4 paneles principales:</p>
<ol style="list-style-type: decimal">
<li>Panel superior izquierdo: editor de texto para escribir comandos/instrucciónes en R (R <em>script</em>), aquí puedes agregar comentarios.</li>
<li>Panel inferior izquierdo: consola de R, donde se ejecutan las líneas de comando en tu <em>script</em>.</li>
<li>Panel superior derecho: aquí puedes visualizar los datos presentes en la memoria de R.</li>
<li>Panel inferior derecho: aquí encuentras 5 pestañas <em>Files/Plots/Packages/Help/Viewer</em> en las que puedes navegar por tus archivos, visualizar tus gráficos en tiempo real, administrar paquetes de R, y pedir ayuda.</li>
</ol>
<p><img src="images/RStudio_overview.png" alt="RStudio" /> RStudio interfaz</p>
<p>Básicamente, lo que haremos es escribir instrucciones (a lo que llamamos comandos) en el lenguaje de programación R, y luego le indicaremos al computador que ejecute la instrucción (a lo que llamamos ejecutar o correr). En RStudio puedes escribir los comandos en el editor de texto y luego ejecutarlos, una línea de código a la vez, presionando <code>Ctrl</code> + <code>Enter</code> (<code>cmd</code> + <code>return</code> en Mac). Cuando ejecutas comandos, es importante poner atención a la consola. Si hubo algún problema con la ejecución de la instrucción, aparecerá un mensaje de error en la consola. Cuando el computador finaliza la instrucción, un nuevo <code>&gt;</code> aparece en la consola indicando que a finalizado de ejecutar el último comando y está listo para correr el siguiente.</p>
</div>
<div id="set-de-datos-para-trabajar" class="section level2">
<h2><span class="header-section-number">1.3</span> Set de datos para trabajar</h2>
<p>Para ésta sección vamos a trabajar con una tabla de datos que contiene información acerca de índices de diversidad de microorganismos presentes en 87 muestras de piel de 3 especies de ballena recolectadas en 3 zonas de Chile (<em>Megaptera novaeangliae</em>, <em>Balaenoptera musculus</em>, <em>Balaenoptera physalus</em>; Estrecho Magallanes, Chiloé, Reserva Nacional Pinguino de Humboldt).</p>
<ul>
<li><p>Descarga la tabla de datos <code>IR_table1.csv</code> <a href="https://www.dropbox.com/s/htbjbqsdrcinrcr/IR_table1.csv?dl=0">AQUÍ</a>.</p></li>
<li><p>Usa la función <code>read.table()</code> para leer o cargar la tabla de datos a la memoria de <strong>R</strong>. La forma de cargar nuevos datos a la memoria de R, es asignar dicho set de datos a un <strong>objeto</strong> usando <code>&lt;-</code> (<strong>objeto &lt;- datos</strong>).</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file =</span> <span class="st">&quot;~/Dropbox/CastroLab_database/workshops_data/IR_table1.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)
<span class="co"># usa la ruta correspondiente en tu computadora hasta el archivo &#39;IR_table1.csv&#39;</span>
<span class="co"># ahora los datos se encuentran guardados en el objeto &quot;data&quot;</span></code></pre></div>
<p><code>file = &quot;&quot;</code>, <code>sep = &quot;&quot;</code> y <code>header = TRUE/FALSE</code> son <strong>argumentos</strong> de la función <code>read.table</code>. Cada vez que llamamos una función debemos usar argumentos para indicar datos de entrada y/o preferencias:</p>
<ul>
<li><code>file = &quot;~/Dropbox/CastroLab_database/workshops_data/IR_table1.csv&quot;</code> para indicar archivo del cual queremos copiar datos y cargarlos a la memoria de R.</li>
<li><code>sep = &quot;,&quot;</code> para indicar el separador de columnas de la tabla.</li>
<li><code>header = TRUE</code> para indicar que la tabla “IR_table1.csv” sí (“TRUE”) contiene <em>headers</em> o títulos de columna, de lo contrario usaríamos “FALSE”.</li>
</ul>
<p>Puedes conocer la descripción de cualquier función y sus argumentos escribiendo “?” + “nombre de la función” en la consola de R (e.g., <code>?read.table</code>).</p>
<p>Cuando cargamos una tabla de datos usando la función <code>read.table()</code>, ésta pasa a conformar lo que se conoce como un <strong><em>data frame</em></strong> en la memoria de R. Un <em>data frame</em> es una representación de los datos en forma de tabla, donde las columnas son <strong>vectores</strong>, todos del mismo largo (igual número de filas). Un vector es el tipo de dato más básico en R, está compuesto por una serie de valores los que pueden ser números o caracteres.</p>
<ul>
<li>Usa la función <code>View()</code> para ver el contenido del objeto <code>data</code>.</li>
</ul>
<pre><code>View(data)</code></pre>
<ul>
<li>Prueba las siguientes funciones para inspeccionar nuestro nuevo <em>data frame</em> “data”:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(data) <span class="co"># muestra número de filas y columnas, respectivamente</span></code></pre></div>
<pre><code>## [1] 87 30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(data) <span class="co"># muestra número de filas</span></code></pre></div>
<pre><code>## [1] 87</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncol</span>(data) <span class="co"># muestra número de columnas</span></code></pre></div>
<pre><code>## [1] 30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(data) <span class="co"># muestra las primeras 6 filas</span></code></pre></div>
<pre><code>##    sample_ID           geo_loc_name                species observed
## 1 SRR6442697 Estrecho de Magallanes Megaptera novaeangliae       31
## 2 SRR6442698 Estrecho de Magallanes Megaptera novaeangliae       33
## 3 SRR6442699 Estrecho de Magallanes Megaptera novaeangliae       43
## 4 SRR6442700 Estrecho de Magallanes Megaptera novaeangliae       29
## 5 SRR6442701 Estrecho de Magallanes Megaptera novaeangliae       26
## 6 SRR6442702 Estrecho de Magallanes Megaptera novaeangliae       21
##    shannon richness_0 richness_20 richness_50 richness_80
## 1 2.121629         31          31          31          31
## 2 1.499137         33          33          33          33
## 3 2.249373         43          43          43          43
## 4 1.306574         29          29          29          29
## 5 1.077438         26          26          26          26
## 6 1.131204         21          21          21          21
##   diversities_inverse_simpson diversities_gini_simpson diversities_shannon
## 1                    6.112104                0.8363902            2.121629
## 2                    2.505873                0.6009375            1.499137
## 3                    7.388570                0.8646558            2.249373
## 4                    2.644111                0.6218011            1.306574
## 5                    1.873331                0.4661914            1.077438
## 6                    2.740500                0.6351030            1.131204
##   diversities_fisher diversities_coverage evenness_camargo evenness_pielou
## 1           3.907415                    3       0.02929889       0.6178324
## 2           4.844428                    1       0.01815948       0.4287528
## 3           5.368153                    3       0.03391424       0.5980465
## 4           3.094775                    1       0.01389960       0.3880188
## 5           2.956294                    1       0.01143026       0.3306954
## 6           2.010698                    2       0.01179407       0.3715539
##   evenness_simpson evenness_evar evenness_bulla dominance_dbp
## 1      0.028296778    0.08554199     0.06038316     0.3022210
## 2      0.011601264    0.11572176     0.05579809     0.6138276
## 3      0.034206345    0.07397473     0.05992808     0.2424974
## 4      0.012241256    0.05943919     0.04011332     0.5250103
## 5      0.008672827    0.08300059     0.04374973     0.7143736
## 6      0.012687499    0.05585996     0.02383196     0.4903917
##   dominance_dmn dominance_absolute dominance_relative dominance_simpson
## 1     0.4948605               3293          0.3022210         0.1636098
## 2     0.7063907               2699          0.6138276         0.3990625
## 3     0.4386486               3919          0.2424974         0.1353442
## 4     0.8384308              19071          0.5250103         0.3781989
## 5     0.8534960              13936          0.7143736         0.5338086
## 6     0.7767577              33864          0.4903917         0.3648970
##   dominance_core_abundance dominance_gini rarity_log_modulo_skewness
## 1                0.5595631      0.9707011                   2.055226
## 2                0.8749147      0.9818405                   2.060118
## 3                0.5033723      0.9660858                   2.059857
## 4                0.9925120      0.9861004                   2.057839
## 5                0.9824175      0.9885697                   2.056901
## 6                0.9981030      0.9882059                   2.049704
##   rarity_low_abundance rarity_noncore_abundance rarity_rare_abundance
## 1          0.009177680              0.076174743           0.076174743
## 2          0.007505117              0.024789629           0.024789629
## 3          0.005692717              0.282965163           0.282965163
## 4          0.002890571              0.000220234           0.000220234
## 5          0.004459709              0.001127742           0.001127742
## 6          0.003301716              0.000086900           0.000086900</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(data) <span class="co"># muestra las últimas 6 filas</span></code></pre></div>
<pre><code>##     sample_ID           geo_loc_name                species observed
## 82 SRR6442787 Estrecho de Magallanes Megaptera novaeangliae       34
## 83 SRR6442788 Estrecho de Magallanes Megaptera novaeangliae       49
## 84 SRR6442789 Estrecho de Magallanes Megaptera novaeangliae       28
## 85 SRR6442790 Estrecho de Magallanes Megaptera novaeangliae       27
## 86 SRR6442792 Estrecho de Magallanes Megaptera novaeangliae       24
## 87 SRR6442794 Estrecho de Magallanes Megaptera novaeangliae       22
##      shannon richness_0 richness_20 richness_50 richness_80
## 82 1.2165375         34          34          34          34
## 83 1.4508829         49          49          49          49
## 84 0.8779605         28          28          28          28
## 85 1.2337859         27          27          27          27
## 86 1.6592270         24          24          24          24
## 87 1.0682126         22          22          22          22
##    diversities_inverse_simpson diversities_gini_simpson
## 82                    2.370590                0.5781641
## 83                    2.723141                0.6327769
## 84                    2.132005                0.5309578
## 85                    2.365953                0.5773373
## 86                    3.274365                0.6945973
## 87                    2.195027                0.5444248
##    diversities_shannon diversities_fisher diversities_coverage
## 82           1.2165375           3.789528                    1
## 83           1.4508829           5.808398                    1
## 84           0.8779605           3.261216                    1
## 85           1.2337859           3.494975                    1
## 86           1.6592270           3.350736                    1
## 87           1.0682126           2.388742                    1
##    evenness_camargo evenness_pielou evenness_simpson evenness_evar
## 82       0.01240594       0.3449839      0.010974954    0.07523218
## 83       0.01636409       0.3728032      0.012607132    0.10265990
## 84       0.01006692       0.2634774      0.009870391    0.10082495
## 85       0.01243090       0.3743468      0.010953485    0.09603370
## 86       0.01921725       0.5220890      0.015159097    0.10629033
## 87       0.01062587       0.3455833      0.010162163    0.06442340
##    evenness_bulla dominance_dbp dominance_dmn dominance_absolute
## 82     0.02951427     0.6173890     0.7687722              18434
## 83     0.05934702     0.5651963     0.7234154              15132
## 84     0.02545193     0.5161512     0.9659794               9012
## 85     0.03539774     0.6129155     0.8023506               4850
## 86     0.05534884     0.5129630     0.6608796               2216
## 87     0.03291487     0.6099778     0.8939806              14562
##    dominance_relative dominance_simpson dominance_core_abundance
## 82          0.6173890         0.4218359                0.9939380
## 83          0.5651963         0.3672231                0.8883203
## 84          0.5161512         0.4690422                0.9822451
## 85          0.6129155         0.4226627                0.9962088
## 86          0.5129630         0.3054027                0.8837963
## 87          0.6099778         0.4555752                0.9965652
##    dominance_gini rarity_log_modulo_skewness rarity_low_abundance
## 82      0.9875941                   2.052933          0.003181727
## 83      0.9836359                   2.057605          0.015164531
## 84      0.9899331                   2.057562          0.006815578
## 85      0.9875691                   2.059455          0.007456085
## 86      0.9807828                   2.058916          0.004166667
## 87      0.9893741                   2.054947          0.002303858
##    rarity_noncore_abundance rarity_rare_abundance
## 82              0.000837297           0.000837297
## 83              0.014044000           0.014044000
## 84              0.014604811           0.014604811
## 85              0.000884620           0.000884620
## 86              0.001157407           0.001157407
## 87              0.000376995           0.000376995</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(data) <span class="co"># calcula estadísticas básicas para cada columna</span></code></pre></div>
<pre><code>##       sample_ID                                 geo_loc_name
##  SRR6442697: 1   Chiloe                               :28   
##  SRR6442698: 1   Estrecho de Magallanes               :41   
##  SRR6442699: 1   Reserva Nacional Pinguino de Humboldt:18   
##  SRR6442700: 1                                              
##  SRR6442701: 1                                              
##  SRR6442702: 1                                              
##  (Other)   :81                                              
##                    species      observed       shannon      
##  Balaenoptera musculus :26   Min.   :13.0   Min.   :0.1675  
##  Balaenoptera physalus : 7   1st Qu.:28.0   1st Qu.:1.1493  
##  Megaptera novaeangliae:54   Median :36.0   Median :1.4509  
##                              Mean   :41.3   Mean   :1.4610  
##                              3rd Qu.:53.0   3rd Qu.:1.7976  
##                              Max.   :84.0   Max.   :3.1401  
##                                                             
##    richness_0    richness_20    richness_50    richness_80  
##  Min.   :13.0   Min.   :13.0   Min.   :13.0   Min.   :13.0  
##  1st Qu.:28.0   1st Qu.:28.0   1st Qu.:28.0   1st Qu.:28.0  
##  Median :36.0   Median :36.0   Median :36.0   Median :36.0  
##  Mean   :41.3   Mean   :41.3   Mean   :41.3   Mean   :41.3  
##  3rd Qu.:53.0   3rd Qu.:53.0   3rd Qu.:53.0   3rd Qu.:53.0  
##  Max.   :84.0   Max.   :84.0   Max.   :84.0   Max.   :84.0  
##                                                             
##  diversities_inverse_simpson diversities_gini_simpson diversities_shannon
##  Min.   : 1.052              Min.   :0.04979          Min.   :0.1675     
##  1st Qu.: 2.164              1st Qu.:0.53769          1st Qu.:1.1493     
##  Median : 2.814              Median :0.64461          Median :1.4509     
##  Mean   : 3.478              Mean   :0.63208          Mean   :1.4610     
##  3rd Qu.: 4.137              3rd Qu.:0.75821          3rd Qu.:1.7976     
##  Max.   :14.576              Max.   :0.93139          Max.   :3.1401     
##                                                                          
##  diversities_fisher diversities_coverage evenness_camargo  
##  Min.   : 1.620     Min.   :1.000        Min.   :0.005441  
##  1st Qu.: 3.286     1st Qu.:1.000        1st Qu.:0.012368  
##  Median : 4.056     Median :2.000        Median :0.016613  
##  Mean   : 5.018     Mean   :1.701        Mean   :0.018888  
##  3rd Qu.: 6.263     3rd Qu.:2.000        3rd Qu.:0.023079  
##  Max.   :13.163     Max.   :5.000        Max.   :0.083105  
##                                                            
##  evenness_pielou   evenness_simpson   evenness_evar     evenness_bulla   
##  Min.   :0.04711   Min.   :0.004872   Min.   :0.05064   Min.   :0.01145  
##  1st Qu.:0.32381   1st Qu.:0.010016   1st Qu.:0.06995   1st Qu.:0.03536  
##  Median :0.38802   Median :0.013027   Median :0.09603   Median :0.04923  
##  Mean   :0.40233   Mean   :0.016100   Mean   :0.10164   Mean   :0.05415  
##  3rd Qu.:0.49853   3rd Qu.:0.019151   3rd Qu.:0.12267   3rd Qu.:0.06665  
##  Max.   :0.74418   Max.   :0.067482   Max.   :0.25815   Max.   :0.19846  
##                                                                          
##  dominance_dbp    dominance_dmn    dominance_absolute dominance_relative
##  Min.   :0.1358   Min.   :0.2602   Min.   :  382      Min.   :0.1358    
##  1st Qu.:0.3772   1st Qu.:0.6092   1st Qu.: 4856      1st Qu.:0.3772    
##  Median :0.4841   Median :0.7482   Median :13936      Median :0.4841    
##  Mean   :0.5042   Mean   :0.7221   Mean   :16988      Mean   :0.5042    
##  3rd Qu.:0.6167   3rd Qu.:0.8478   3rd Qu.:20533      3rd Qu.:0.6167    
##  Max.   :0.9747   Max.   :0.9932   Max.   :80901      Max.   :0.9747    
##                                                                         
##  dominance_simpson dominance_core_abundance dominance_gini  
##  Min.   :0.06861   Min.   :0.0063           Min.   :0.9169  
##  1st Qu.:0.24179   1st Qu.:0.4664           1st Qu.:0.9769  
##  Median :0.35539   Median :0.9189           Median :0.9834  
##  Mean   :0.36792   Mean   :0.7313           Mean   :0.9811  
##  3rd Qu.:0.46231   3rd Qu.:0.9736           3rd Qu.:0.9876  
##  Max.   :0.95021   Max.   :0.9988           Max.   :0.9946  
##                                                             
##  rarity_log_modulo_skewness rarity_low_abundance rarity_noncore_abundance
##  Min.   :1.976              Min.   :0.001072     Min.   :0.0000869       
##  1st Qu.:2.054              1st Qu.:0.004414     1st Qu.:0.0017489       
##  Median :2.058              Median :0.007645     Median :0.0062500       
##  Mean   :2.053              Mean   :0.010067     Mean   :0.0630320       
##  3rd Qu.:2.060              3rd Qu.:0.013359     3rd Qu.:0.0252855       
##  Max.   :2.061              Max.   :0.039322     Max.   :0.9751045       
##                                                                          
##  rarity_rare_abundance
##  Min.   :0.0000869    
##  1st Qu.:0.0017489    
##  Median :0.0062500    
##  Mean   :0.0630320    
##  3rd Qu.:0.0252855    
##  Max.   :0.9751045    
## </code></pre>
</div>
<div id="extraer-informacion-de-tablas" class="section level2">
<h2><span class="header-section-number">1.4</span> Extraer información de tablas</h2>
<p>Nuestra tabla de datos de estudio (<code>data</code>) consta de filas y columnas (2 dimensiones), si queremos extraer algunos datos de interés, debemos especificar las “<strong>coordinadas</strong>” de los datos que queremos obtener. Primero el número(s) de fila, seguido por el número(s) de columna. Existen diferentes formas de especificar coordenadas, que nos llevaran a obtener datos de diferente clase o tipo.</p>
<ul>
<li>Primer elemento en la primera columna del <em>data frame</em>, como vector:</li>
</ul>
<pre><code>data[1, 1]</code></pre>
<ul>
<li>Primer elemento en la sexta columna, como vector:</li>
</ul>
<pre><code>data[1, 6]</code></pre>
<ul>
<li>Primera columna del <em>data frame</em>, como vector:</li>
</ul>
<pre><code>data[, 1]</code></pre>
<ul>
<li>Primera columna del <em>data frame</em>, como <em>data frame</em>:</li>
</ul>
<pre><code>data[1]</code></pre>
<ul>
<li>Primeros tres elementos en la séptima columna, como vector:</li>
</ul>
<pre><code>data[1:3, 7] # filas 1 a 3 de la columna 7</code></pre>
<ul>
<li>La tercera fila del <em>data frame</em>, como <em>data frame</em>:</li>
</ul>
<pre><code>data[3, ]</code></pre>
<ul>
<li>Equivalente a la función <code>head()</code>:</li>
</ul>
<pre><code>data[1:6, ] </code></pre>
<ul>
<li>También puedes excluir datos usando el símbolo <code>-</code> (“<em>todo menos…</em>”):</li>
</ul>
<pre><code>data[, -1]    # todo excepto la primera columna
data[-c(7:87), ] # equivalente a head(data)</code></pre>
<p>La función <code>c()</code> se utiliza para indicar una serie de valores o asignar una serie de valores a un vector (e.g., <code>peso_kg &lt;- c(60,55,64,80,74)</code>).</p>
<ul>
<li>También puedes extraer datos usando el nombre de las columnas o <em>headers</em>:</li>
</ul>
<pre><code>data[&quot;species&quot;]    # resultado como data.frame
data[, &quot;species&quot;]    # resultado como vector
data[[&quot;species&quot;]]    # resultado como vector
data$species    # resultado como vector</code></pre>
<p>Puedes revisar los <em>headers</em> disponibles en tu <em>data frame</em> usando las funciones <code>colnames(data)</code> o <code>View(data)</code>.</p>
<p><strong>RStudio</strong> cuenta con una muy útil <strong>función de autocompletado</strong>, presiona <code>tab</code> (tabulador) para obtener nombres completos y correctos de funciones, columnas (<em>headers</em>), etc.</p>
</div>
<div id="factores" class="section level2">
<h2><span class="header-section-number">1.5</span> Factores</h2>
<ul>
<li>La función <code>str()</code> muestra la estructura de un objeto e información acerca de la clase y contenido de cada columna:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(data)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    87 obs. of  30 variables:
##  $ sample_ID                  : Factor w/ 87 levels &quot;SRR6442697&quot;,&quot;SRR6442698&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ geo_loc_name               : Factor w/ 3 levels &quot;Chiloe&quot;,&quot;Estrecho de Magallanes&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ species                    : Factor w/ 3 levels &quot;Balaenoptera musculus&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ observed                   : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ shannon                    : num  2.12 1.5 2.25 1.31 1.08 ...
##  $ richness_0                 : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_20                : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_50                : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_80                : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ diversities_inverse_simpson: num  6.11 2.51 7.39 2.64 1.87 ...
##  $ diversities_gini_simpson   : num  0.836 0.601 0.865 0.622 0.466 ...
##  $ diversities_shannon        : num  2.12 1.5 2.25 1.31 1.08 ...
##  $ diversities_fisher         : num  3.91 4.84 5.37 3.09 2.96 ...
##  $ diversities_coverage       : int  3 1 3 1 1 2 2 1 2 1 ...
##  $ evenness_camargo           : num  0.0293 0.0182 0.0339 0.0139 0.0114 ...
##  $ evenness_pielou            : num  0.618 0.429 0.598 0.388 0.331 ...
##  $ evenness_simpson           : num  0.0283 0.0116 0.03421 0.01224 0.00867 ...
##  $ evenness_evar              : num  0.0855 0.1157 0.074 0.0594 0.083 ...
##  $ evenness_bulla             : num  0.0604 0.0558 0.0599 0.0401 0.0437 ...
##  $ dominance_dbp              : num  0.302 0.614 0.242 0.525 0.714 ...
##  $ dominance_dmn              : num  0.495 0.706 0.439 0.838 0.853 ...
##  $ dominance_absolute         : int  3293 2699 3919 19071 13936 33864 5957 30937 10163 35049 ...
##  $ dominance_relative         : num  0.302 0.614 0.242 0.525 0.714 ...
##  $ dominance_simpson          : num  0.164 0.399 0.135 0.378 0.534 ...
##  $ dominance_core_abundance   : num  0.56 0.875 0.503 0.993 0.982 ...
##  $ dominance_gini             : num  0.971 0.982 0.966 0.986 0.989 ...
##  $ rarity_log_modulo_skewness : num  2.06 2.06 2.06 2.06 2.06 ...
##  $ rarity_low_abundance       : num  0.00918 0.00751 0.00569 0.00289 0.00446 ...
##  $ rarity_noncore_abundance   : num  0.07617 0.02479 0.28297 0.00022 0.00113 ...
##  $ rarity_rare_abundance      : num  0.07617 0.02479 0.28297 0.00022 0.00113 ...</code></pre>
<p>Como podrás ver en el <em>output</em> de <code>str(data)</code> que las columnas <code>sample_ID</code>, <code>geo_loc_name</code> y <code>species</code> son de una clase llamada <code>Factor</code>. <strong>Factores representan datos categóricos</strong>. Son guardados en la memoria de R como números enteros (<em>integers</em>), los que pueden estar ordenados o desordenados.</p>
<p>Los factores contienen un set de valores pre-definidos, conocidos como <strong><em>levels</em></strong>. Por defecto, R ordena los <em>levels</em> en orden alfabético. Por ejemplo, en nuestro objeto <code>data</code> la columna <code>species</code> es un <code>Factor</code> con 3 <em>levels</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(data<span class="op">$</span>species)</code></pre></div>
<pre><code>## [1] &quot;Balaenoptera musculus&quot;  &quot;Balaenoptera physalus&quot; 
## [3] &quot;Megaptera novaeangliae&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nlevels</span>(data<span class="op">$</span>species)</code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>R asigna <strong>1</strong> al <em>level</em> “Balaenoptera musculus”, <strong>2</strong> al <em>level</em> “Balaenoptera physalus” y <strong>3</strong> al <em>level</em> “Megaptera novaeangliae”.</p>
<p>Algunas veces, el orden de los factores no importa, pero otras veces vamos a requerir especificar el orden porque es importante para el análisis o visualización de los datos. Una forma de re-ordenar los <em>levels</em> del factor <code>species</code> es:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(data<span class="op">$</span>species)    <span class="co"># orden actual</span></code></pre></div>
<pre><code>## [1] &quot;Balaenoptera musculus&quot;  &quot;Balaenoptera physalus&quot; 
## [3] &quot;Megaptera novaeangliae&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data<span class="op">$</span>species &lt;-<span class="st"> </span><span class="kw">factor</span>(data<span class="op">$</span>species, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Megaptera novaeangliae&quot;</span>, <span class="st">&quot;Balaenoptera musculus&quot;</span>, <span class="st">&quot;Balaenoptera physalus&quot;</span>))
<span class="kw">levels</span>(data<span class="op">$</span>species)    <span class="co"># después de re-ordenar</span></code></pre></div>
<pre><code>## [1] &quot;Megaptera novaeangliae&quot; &quot;Balaenoptera musculus&quot; 
## [3] &quot;Balaenoptera physalus&quot;</code></pre>
<div id="transformar-factores" class="section level3">
<h3><span class="header-section-number">1.5.1</span> Transformar factores</h3>
<ul>
<li>Para transformar un <code>factor</code> a un <code>vector</code> de <code>caracteres</code>, puedes usar la función <code>as.character()</code>:</li>
</ul>
<pre><code>as.character(data$species)</code></pre>
<ul>
<li>Transformar o convertir factores cuyos niveles son números (e.g., años) a un vector numérico es un poco más complejo. La función <code>as.numeric()</code> muestra los números enteros asignados a cada <em>level</em>, no los niveles en si. Una manera de evitarlo es convertir los factores a caracteres, y luego a números:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">year_fct &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="dv">1990</span>, <span class="dv">1983</span>, <span class="dv">1977</span>, <span class="dv">1998</span>, <span class="dv">1990</span>))
<span class="kw">as.numeric</span>(year_fct)    <span class="co"># equivocado! sin mensajes de error...</span></code></pre></div>
<pre><code>## [1] 3 2 1 4 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(year_fct))    <span class="co"># funciona!</span></code></pre></div>
<pre><code>## [1] 1990 1983 1977 1998 1990</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># otra forma es usar la función levels()</span>
<span class="kw">as.numeric</span>(<span class="kw">levels</span>(year_fct))[year_fct]    <span class="co"># funciona!</span></code></pre></div>
<pre><code>## [1] 1990 1983 1977 1998 1990</code></pre>
</div>
<div id="renombrar-factores" class="section level3">
<h3><span class="header-section-number">1.5.2</span> Renombrar factores</h3>
<p>¿Necesitas renombrar algún elemento en tus datos? Supongamos que queremos cambiar el nombre de la especie “<em>Megaptera novaeangliae</em>” por el nombre común “ballena jorobada”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">species &lt;-<span class="st"> </span>data<span class="op">$</span>species    <span class="co"># copiamos la columna &quot;species&quot; en un objeto aparte para no alterar nuestro set de datos original</span>
<span class="kw">head</span>(species)</code></pre></div>
<pre><code>## [1] Megaptera novaeangliae Megaptera novaeangliae Megaptera novaeangliae
## [4] Megaptera novaeangliae Megaptera novaeangliae Megaptera novaeangliae
## 3 Levels: Megaptera novaeangliae ... Balaenoptera physalus</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(species)    <span class="co"># identifica la posición del level que quieres renombrar (1)</span></code></pre></div>
<pre><code>## [1] &quot;Megaptera novaeangliae&quot; &quot;Balaenoptera musculus&quot; 
## [3] &quot;Balaenoptera physalus&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(species)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;ballena jorobada&quot;</span>
<span class="kw">levels</span>(species)</code></pre></div>
<pre><code>## [1] &quot;ballena jorobada&quot;      &quot;Balaenoptera musculus&quot; &quot;Balaenoptera physalus&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(species)</code></pre></div>
<pre><code>## [1] ballena jorobada ballena jorobada ballena jorobada ballena jorobada
## [5] ballena jorobada ballena jorobada
## 3 Levels: ballena jorobada ... Balaenoptera physalus</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># también puedes hacerlo para los otros dos levels</span>
<span class="kw">levels</span>(species)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;ballena azul&quot;</span>
<span class="kw">levels</span>(species)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;ballena de aleta&quot;</span>
<span class="kw">levels</span>(species)</code></pre></div>
<pre><code>## [1] &quot;ballena jorobada&quot; &quot;ballena azul&quot;     &quot;ballena de aleta&quot;</code></pre>
</div>
<div id="argumento-stringsasfactors" class="section level3">
<h3><span class="header-section-number">1.5.3</span> Argumento <code>stringsAsFactors</code></h3>
<p>Por defecto, al importar un <em>data frame</em> en R, las columnas que contienen caracteres (i.e. texto) son convertidas en factores. Dependiendo de qué queramos hacer con los datos, en algún caso podríamos necesitar que la columna se mantenga como caracter. Para ésto, la función <code>read.table()</code> tiene disponible el argumento <code>stringsAsFactors</code> que puede ser definido como “FALSE” (<code>stringsAsFactors = FALSE</code>).</p>
<ul>
<li>Compara la diferencia entre la tabla de datos de estudio leída como <code>factor</code> vs. <code>caracter</code>:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;~/Dropbox/CastroLab_database/workshops_data/IR_table1.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)
<span class="kw">str</span>(data)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    87 obs. of  30 variables:
##  $ sample_ID                  : Factor w/ 87 levels &quot;SRR6442697&quot;,&quot;SRR6442698&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ geo_loc_name               : Factor w/ 3 levels &quot;Chiloe&quot;,&quot;Estrecho de Magallanes&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ species                    : Factor w/ 3 levels &quot;Balaenoptera musculus&quot;,..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ observed                   : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ shannon                    : num  2.12 1.5 2.25 1.31 1.08 ...
##  $ richness_0                 : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_20                : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_50                : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_80                : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ diversities_inverse_simpson: num  6.11 2.51 7.39 2.64 1.87 ...
##  $ diversities_gini_simpson   : num  0.836 0.601 0.865 0.622 0.466 ...
##  $ diversities_shannon        : num  2.12 1.5 2.25 1.31 1.08 ...
##  $ diversities_fisher         : num  3.91 4.84 5.37 3.09 2.96 ...
##  $ diversities_coverage       : int  3 1 3 1 1 2 2 1 2 1 ...
##  $ evenness_camargo           : num  0.0293 0.0182 0.0339 0.0139 0.0114 ...
##  $ evenness_pielou            : num  0.618 0.429 0.598 0.388 0.331 ...
##  $ evenness_simpson           : num  0.0283 0.0116 0.03421 0.01224 0.00867 ...
##  $ evenness_evar              : num  0.0855 0.1157 0.074 0.0594 0.083 ...
##  $ evenness_bulla             : num  0.0604 0.0558 0.0599 0.0401 0.0437 ...
##  $ dominance_dbp              : num  0.302 0.614 0.242 0.525 0.714 ...
##  $ dominance_dmn              : num  0.495 0.706 0.439 0.838 0.853 ...
##  $ dominance_absolute         : int  3293 2699 3919 19071 13936 33864 5957 30937 10163 35049 ...
##  $ dominance_relative         : num  0.302 0.614 0.242 0.525 0.714 ...
##  $ dominance_simpson          : num  0.164 0.399 0.135 0.378 0.534 ...
##  $ dominance_core_abundance   : num  0.56 0.875 0.503 0.993 0.982 ...
##  $ dominance_gini             : num  0.971 0.982 0.966 0.986 0.989 ...
##  $ rarity_log_modulo_skewness : num  2.06 2.06 2.06 2.06 2.06 ...
##  $ rarity_low_abundance       : num  0.00918 0.00751 0.00569 0.00289 0.00446 ...
##  $ rarity_noncore_abundance   : num  0.07617 0.02479 0.28297 0.00022 0.00113 ...
##  $ rarity_rare_abundance      : num  0.07617 0.02479 0.28297 0.00022 0.00113 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;~/Dropbox/CastroLab_database/workshops_data/IR_table1.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">str</span>(data)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    87 obs. of  30 variables:
##  $ sample_ID                  : chr  &quot;SRR6442697&quot; &quot;SRR6442698&quot; &quot;SRR6442699&quot; &quot;SRR6442700&quot; ...
##  $ geo_loc_name               : chr  &quot;Estrecho de Magallanes&quot; &quot;Estrecho de Magallanes&quot; &quot;Estrecho de Magallanes&quot; &quot;Estrecho de Magallanes&quot; ...
##  $ species                    : chr  &quot;Megaptera novaeangliae&quot; &quot;Megaptera novaeangliae&quot; &quot;Megaptera novaeangliae&quot; &quot;Megaptera novaeangliae&quot; ...
##  $ observed                   : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ shannon                    : num  2.12 1.5 2.25 1.31 1.08 ...
##  $ richness_0                 : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_20                : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_50                : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_80                : int  31 33 43 29 26 21 37 32 28 30 ...
##  $ diversities_inverse_simpson: num  6.11 2.51 7.39 2.64 1.87 ...
##  $ diversities_gini_simpson   : num  0.836 0.601 0.865 0.622 0.466 ...
##  $ diversities_shannon        : num  2.12 1.5 2.25 1.31 1.08 ...
##  $ diversities_fisher         : num  3.91 4.84 5.37 3.09 2.96 ...
##  $ diversities_coverage       : int  3 1 3 1 1 2 2 1 2 1 ...
##  $ evenness_camargo           : num  0.0293 0.0182 0.0339 0.0139 0.0114 ...
##  $ evenness_pielou            : num  0.618 0.429 0.598 0.388 0.331 ...
##  $ evenness_simpson           : num  0.0283 0.0116 0.03421 0.01224 0.00867 ...
##  $ evenness_evar              : num  0.0855 0.1157 0.074 0.0594 0.083 ...
##  $ evenness_bulla             : num  0.0604 0.0558 0.0599 0.0401 0.0437 ...
##  $ dominance_dbp              : num  0.302 0.614 0.242 0.525 0.714 ...
##  $ dominance_dmn              : num  0.495 0.706 0.439 0.838 0.853 ...
##  $ dominance_absolute         : int  3293 2699 3919 19071 13936 33864 5957 30937 10163 35049 ...
##  $ dominance_relative         : num  0.302 0.614 0.242 0.525 0.714 ...
##  $ dominance_simpson          : num  0.164 0.399 0.135 0.378 0.534 ...
##  $ dominance_core_abundance   : num  0.56 0.875 0.503 0.993 0.982 ...
##  $ dominance_gini             : num  0.971 0.982 0.966 0.986 0.989 ...
##  $ rarity_log_modulo_skewness : num  2.06 2.06 2.06 2.06 2.06 ...
##  $ rarity_low_abundance       : num  0.00918 0.00751 0.00569 0.00289 0.00446 ...
##  $ rarity_noncore_abundance   : num  0.07617 0.02479 0.28297 0.00022 0.00113 ...
##  $ rarity_rare_abundance      : num  0.07617 0.02479 0.28297 0.00022 0.00113 ...</code></pre>
</div>
</div>
</div>
<div id="manipulacion-de-datos-en-r" class="section level1">
<h1><span class="header-section-number">2</span> Manipulación de datos en R</h1>
<p>Las funciones que hemos estado usando hasta ahora, como <code>read.table</code> y <code>str()</code>, vienen incorporadas en <strong>R</strong>. Pero existen incontables funciones en R a las que puedes acceder instalando lo que se conoce como <strong>paquetes</strong> (<strong><em>packages</em></strong>). Antes de usar un paquete por primera vez, primero debes instalarlo y luego debes importarlo en cada sesión de R en la que quieras usarlo.</p>
<p>Hay dos formas de <strong>instalar paquetes en R</strong>, a través de la consola y a través de la opción <code>Install</code> en la pestaña <code>Packages</code> de <strong>RStudio</strong>:</p>
<ol style="list-style-type: decimal">
<li>Para instalar e importar el paquete <code>tidyverse</code> usando la consola, escribe:</li>
</ol>
<pre><code>install.packages(&quot;tidyverse&quot;)
library(tidyverse)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Para instalar e importar el paquete <code>tidyverse</code> usando RStudio, dirígete a la pestaña <code>Packages</code> -&gt; <code>Install</code> -&gt; escribe el nombre del paquete y haz clic en “Install”. Una vez instalado, para importarlo sólo debes identificarlo y seleccionarlo en la lista de paquetes.</li>
</ol>
<p><img src="images/InstallPackages_RStudio.png" alt="install_packages" /> Instalación de paquetes en RStudio</p>
<p><code>tidyverse</code> es un paquete que incluye la instalación varios paquetes ´útiles para la manipulaci´ón y an´álisis de datos, tales como <code>dplyr</code>, <code>tidyr</code>, <code>ggplot2</code>, etc. Anteriormente practicamos como extraer información de tablas usando <code>[ ]</code>, a continuación vamos a utilizar los paquetes <code>dplyr</code> y <code>tidyr</code> para manipular nuestra tabla de datos más fácil, rápido y con más funcionalidades.</p>
<ul>
<li>Vamos a leer nuevamente nuestra tabla de datos, ésta vez usando la función <code>read_csv()</code> del paquete <code>tidyverse</code>:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;~/Dropbox/CastroLab_database/workshops_data/IR_table1.csv&quot;</span>)</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   sample_ID = col_character(),
##   geo_loc_name = col_character(),
##   species = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Usa la función str() para inspeccionar los datos</span>
<span class="kw">str</span>(data)</code></pre></div>
<pre><code>## Classes &#39;spec_tbl_df&#39;, &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;: 87 obs. of  30 variables:
##  $ sample_ID                  : chr  &quot;SRR6442697&quot; &quot;SRR6442698&quot; &quot;SRR6442699&quot; &quot;SRR6442700&quot; ...
##  $ geo_loc_name               : chr  &quot;Estrecho de Magallanes&quot; &quot;Estrecho de Magallanes&quot; &quot;Estrecho de Magallanes&quot; &quot;Estrecho de Magallanes&quot; ...
##  $ species                    : chr  &quot;Megaptera novaeangliae&quot; &quot;Megaptera novaeangliae&quot; &quot;Megaptera novaeangliae&quot; &quot;Megaptera novaeangliae&quot; ...
##  $ observed                   : num  31 33 43 29 26 21 37 32 28 30 ...
##  $ shannon                    : num  2.12 1.5 2.25 1.31 1.08 ...
##  $ richness_0                 : num  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_20                : num  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_50                : num  31 33 43 29 26 21 37 32 28 30 ...
##  $ richness_80                : num  31 33 43 29 26 21 37 32 28 30 ...
##  $ diversities_inverse_simpson: num  6.11 2.51 7.39 2.64 1.87 ...
##  $ diversities_gini_simpson   : num  0.836 0.601 0.865 0.622 0.466 ...
##  $ diversities_shannon        : num  2.12 1.5 2.25 1.31 1.08 ...
##  $ diversities_fisher         : num  3.91 4.84 5.37 3.09 2.96 ...
##  $ diversities_coverage       : num  3 1 3 1 1 2 2 1 2 1 ...
##  $ evenness_camargo           : num  0.0293 0.0182 0.0339 0.0139 0.0114 ...
##  $ evenness_pielou            : num  0.618 0.429 0.598 0.388 0.331 ...
##  $ evenness_simpson           : num  0.0283 0.0116 0.03421 0.01224 0.00867 ...
##  $ evenness_evar              : num  0.0855 0.1157 0.074 0.0594 0.083 ...
##  $ evenness_bulla             : num  0.0604 0.0558 0.0599 0.0401 0.0437 ...
##  $ dominance_dbp              : num  0.302 0.614 0.242 0.525 0.714 ...
##  $ dominance_dmn              : num  0.495 0.706 0.439 0.838 0.853 ...
##  $ dominance_absolute         : num  3293 2699 3919 19071 13936 ...
##  $ dominance_relative         : num  0.302 0.614 0.242 0.525 0.714 ...
##  $ dominance_simpson          : num  0.164 0.399 0.135 0.378 0.534 ...
##  $ dominance_core_abundance   : num  0.56 0.875 0.503 0.993 0.982 ...
##  $ dominance_gini             : num  0.971 0.982 0.966 0.986 0.989 ...
##  $ rarity_log_modulo_skewness : num  2.06 2.06 2.06 2.06 2.06 ...
##  $ rarity_low_abundance       : num  0.00918 0.00751 0.00569 0.00289 0.00446 ...
##  $ rarity_noncore_abundance   : num  0.07617 0.02479 0.28297 0.00022 0.00113 ...
##  $ rarity_rare_abundance      : num  0.07617 0.02479 0.28297 0.00022 0.00113 ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   sample_ID = col_character(),
##   ..   geo_loc_name = col_character(),
##   ..   species = col_character(),
##   ..   observed = col_double(),
##   ..   shannon = col_double(),
##   ..   richness_0 = col_double(),
##   ..   richness_20 = col_double(),
##   ..   richness_50 = col_double(),
##   ..   richness_80 = col_double(),
##   ..   diversities_inverse_simpson = col_double(),
##   ..   diversities_gini_simpson = col_double(),
##   ..   diversities_shannon = col_double(),
##   ..   diversities_fisher = col_double(),
##   ..   diversities_coverage = col_double(),
##   ..   evenness_camargo = col_double(),
##   ..   evenness_pielou = col_double(),
##   ..   evenness_simpson = col_double(),
##   ..   evenness_evar = col_double(),
##   ..   evenness_bulla = col_double(),
##   ..   dominance_dbp = col_double(),
##   ..   dominance_dmn = col_double(),
##   ..   dominance_absolute = col_double(),
##   ..   dominance_relative = col_double(),
##   ..   dominance_simpson = col_double(),
##   ..   dominance_core_abundance = col_double(),
##   ..   dominance_gini = col_double(),
##   ..   rarity_log_modulo_skewness = col_double(),
##   ..   rarity_low_abundance = col_double(),
##   ..   rarity_noncore_abundance = col_double(),
##   ..   rarity_rare_abundance = col_double()
##   .. )</code></pre>
<p>Como podrás notar, la función <code>read_csv()</code> hace algunos cambios al cargar la tabla con respecto a lo que revisamos anteriormente usando <code>read.table()</code>. Las diferencias son:</p>
<ol style="list-style-type: decimal">
<li>Al leer la tabla, muestra un resumen del tipo de dato de cada columna, y sólo muestra las primeras filas y tantas columnas como se puedan visualizar en la pantalla.</li>
<li>Las columnas de clase <code>character</code> (caracteres) <strong>no</strong> son convertidas en factores.</li>
</ol>
<p>A continuación vamos a aprender algunas de las funciones más comunes de <code>dplyr</code>:</p>
<ul>
<li><code>select()</code>: extraer columnas.</li>
<li><code>filter()</code>: extraer filas según condiciones.</li>
<li><code>mutate()</code>: crear nuevas columnas usando la información de otras columnas.</li>
<li><code>group_by()</code> y <code>summarize()</code>: cálcula estadísticas en datos agrupados.</li>
<li><code>arrange()</code>: ordena resultados.</li>
<li><code>count()</code>: conteo de datos.</li>
</ul>
<div id="seleccionar-columnas-y-filtrar-filas" class="section level2">
<h2><span class="header-section-number">2.1</span> Seleccionar columnas y filtrar filas</h2>
<ul>
<li>Para <strong>seleccionar columnas</strong> de una tabla de datos o <em>data frame</em>, vamos a usar la función <code>select()</code>. Luego, para <strong>seleccionar filas</strong> de acuerdo a cierto criterio (filtrar), vamos a usar la función <code>filter()</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(data, sample_ID, geo_loc_name, species, observed) <span class="co"># los argumentos son, primero el objeto que contiene el data frame, y luego los títulos de las columnas a extraer</span></code></pre></div>
<pre><code>## # A tibble: 87 x 4
##    sample_ID  geo_loc_name           species                observed
##    &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;                     &lt;dbl&gt;
##  1 SRR6442697 Estrecho de Magallanes Megaptera novaeangliae       31
##  2 SRR6442698 Estrecho de Magallanes Megaptera novaeangliae       33
##  3 SRR6442699 Estrecho de Magallanes Megaptera novaeangliae       43
##  4 SRR6442700 Estrecho de Magallanes Megaptera novaeangliae       29
##  5 SRR6442701 Estrecho de Magallanes Megaptera novaeangliae       26
##  6 SRR6442702 Estrecho de Magallanes Megaptera novaeangliae       21
##  7 SRR6442703 Estrecho de Magallanes Megaptera novaeangliae       37
##  8 SRR6442704 Estrecho de Magallanes Megaptera novaeangliae       32
##  9 SRR6442705 Estrecho de Magallanes Megaptera novaeangliae       28
## 10 SRR6442706 Estrecho de Magallanes Megaptera novaeangliae       30
## # … with 77 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dplyr<span class="op">::</span><span class="kw">filter</span>(data, geo_loc_name <span class="op">==</span><span class="st"> &quot;Chiloe&quot;</span>) <span class="co"># los argumentos son, primero el objeto que contiene el data frame, y luego la columna con el criterio de filtro</span></code></pre></div>
<pre><code>## # A tibble: 28 x 30
##    sample_ID geo_loc_name species observed shannon richness_0 richness_20
##    &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
##  1 SRR64427… Chiloe       Megapt…       63   1.28          63          63
##  2 SRR64427… Chiloe       Megapt…       14   0.732         14          14
##  3 SRR64427… Chiloe       Balaen…       18   1.41          18          18
##  4 SRR64427… Chiloe       Balaen…       19   1.68          19          19
##  5 SRR64427… Chiloe       Balaen…       36   2.31          36          36
##  6 SRR64427… Chiloe       Balaen…       63   1.31          63          63
##  7 SRR64427… Chiloe       Balaen…       29   1.73          29          29
##  8 SRR64427… Chiloe       Balaen…       38   1.65          38          38
##  9 SRR64427… Chiloe       Balaen…       81   2.05          81          81
## 10 SRR64427… Chiloe       Balaen…       78   0.725         78          78
## # … with 18 more rows, and 23 more variables: richness_50 &lt;dbl&gt;,
## #   richness_80 &lt;dbl&gt;, diversities_inverse_simpson &lt;dbl&gt;,
## #   diversities_gini_simpson &lt;dbl&gt;, diversities_shannon &lt;dbl&gt;,
## #   diversities_fisher &lt;dbl&gt;, diversities_coverage &lt;dbl&gt;,
## #   evenness_camargo &lt;dbl&gt;, evenness_pielou &lt;dbl&gt;, evenness_simpson &lt;dbl&gt;,
## #   evenness_evar &lt;dbl&gt;, evenness_bulla &lt;dbl&gt;, dominance_dbp &lt;dbl&gt;,
## #   dominance_dmn &lt;dbl&gt;, dominance_absolute &lt;dbl&gt;,
## #   dominance_relative &lt;dbl&gt;, dominance_simpson &lt;dbl&gt;,
## #   dominance_core_abundance &lt;dbl&gt;, dominance_gini &lt;dbl&gt;,
## #   rarity_log_modulo_skewness &lt;dbl&gt;, rarity_low_abundance &lt;dbl&gt;,
## #   rarity_noncore_abundance &lt;dbl&gt;, rarity_rare_abundance &lt;dbl&gt;</code></pre>
<p>Es importante tener en cuenta que <strong>funciones provenientes de diferentes paquetes de R pueden tener el mismo nombre</strong>. Esto es altamente probable considerando que solo el repositorio CRAN contiene más de 10.000 paquetes. Por lo tanto, en ocasiones es necesario agregar el paquete fuente de la función a utilizar, así: <code>dplyr::filter()</code>. Con el fin de evitar errores asociados a la ejecución de una función no diferente a la deseada, pero que tiene el mismo nombre.</p>
<p>Para saber si el nombre función a utilizar se repite en otros paquetes, escribe en la consola el signo de interrogación seguido por el nombre de la función, así: <code>?filter</code> Si el nombre se repite en diferentes paquetes, verás una lista en la pestaña <code>Help</code> de RStudio, sino verás la página de ayuda de la función directamente.</p>
<p><strong>¿Quieres seleccionar y filtrar al mismo tiempo?</strong> Claro! Hay formas de hacer varias operaciones consecutivas en una misma instrucción, de esta manera evitamos tener que guardar <code>objetos</code> “intermedios” innecesariamente.</p>
</div>
<div id="funciones-anidadas-y-pipes" class="section level2">
<h2><span class="header-section-number">2.2</span> Funciones anidadas y <strong><em>pipes</em></strong></h2>
<ul>
<li>Vamos a anidar funciones (i.e. una función dentro de otra):</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(data)</code></pre></div>
<pre><code>## [1] 87</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncol</span>(data)</code></pre></div>
<pre><code>## [1] 30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_div &lt;-<span class="st"> </span><span class="kw">select</span>(<span class="kw">filter</span>(data, shannon <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.5</span>), sample_ID, geo_loc_name, species, observed, shannon)
<span class="kw">head</span>(data_div)</code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   sample_ID  geo_loc_name           species                observed shannon
##   &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;                     &lt;dbl&gt;   &lt;dbl&gt;
## 1 SRR6442697 Estrecho de Magallanes Megaptera novaeangliae       31    2.12
## 2 SRR6442699 Estrecho de Magallanes Megaptera novaeangliae       43    2.25
## 3 SRR6442703 Estrecho de Magallanes Megaptera novaeangliae       37    1.86
## 4 SRR6442708 Estrecho de Magallanes Megaptera novaeangliae       27    1.91
## 5 SRR6442709 Estrecho de Magallanes Megaptera novaeangliae       36    1.88
## 6 SRR6442712 Estrecho de Magallanes Megaptera novaeangliae       36    1.94</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(data_div) <span class="co"># 39 muestras tienen un índice de shannon mayor a 1.5</span></code></pre></div>
<pre><code>## [1] 39</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncol</span>(data_div)</code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>Es importante recordar que <strong>R lee la línea de comando desde dentro hacia fuera</strong>. En éste caso, primero se hizo el filtro y luego la selección.</p>
<ul>
<li>Usar funciones anidadas puede ser engorroso cuando quieres hacer muchas operaciones consecutivas, en cuyo caso es convenientes usar <em>pipes</em>. <strong><em>Pipes</em></strong> te permiten usar varias funciones consecutivas, de forma que el <strong><em>output</em> de una función será en <em>input</em> de la siguiente</strong>. Los <em>pipes</em> en R lucen así: <code>%&gt;%</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(shannon <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.5</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(sample_ID, geo_loc_name, species, observed, shannon)</code></pre></div>
<pre><code>## # A tibble: 39 x 5
##    sample_ID  geo_loc_name           species               observed shannon
##    &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;                    &lt;dbl&gt;   &lt;dbl&gt;
##  1 SRR6442697 Estrecho de Magallanes Megaptera novaeangli…       31    2.12
##  2 SRR6442699 Estrecho de Magallanes Megaptera novaeangli…       43    2.25
##  3 SRR6442703 Estrecho de Magallanes Megaptera novaeangli…       37    1.86
##  4 SRR6442708 Estrecho de Magallanes Megaptera novaeangli…       27    1.91
##  5 SRR6442709 Estrecho de Magallanes Megaptera novaeangli…       36    1.88
##  6 SRR6442712 Estrecho de Magallanes Megaptera novaeangli…       36    1.94
##  7 SRR6442714 Estrecho de Magallanes Megaptera novaeangli…       26    1.81
##  8 SRR6442715 Estrecho de Magallanes Megaptera novaeangli…       35    1.61
##  9 SRR6442722 Chiloe                 Balaenoptera musculus       19    1.68
## 10 SRR6442723 Chiloe                 Balaenoptera musculus       36    2.31
## # … with 29 more rows</code></pre>
<p>Como <strong><code>%&gt;%</code> pasa el <code>objeto</code> de su izquierda como el primer argumento de la función a su derecha</strong>, no necesitamos especificar el <em>data frame</em> como el primer argumento de las funciones <code>filter()</code> y <code>select()</code>.</p>
</div>
<div id="mutate-crear-nuevas-columnas-desde-informacion-existente-en-otras-columnas" class="section level2">
<h2><span class="header-section-number">2.3</span> <strong><em>Mutate</em></strong>: crear nuevas columnas desde información existente en otras columnas</h2>
<p>En algunas ocasiones necesitamos generar nueva información a partir de la existente, por ejemplo, para hacer conversiones o cálculos matemáticos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">log10_dom_abs =</span> <span class="kw">log10</span>(dominance_absolute))
<span class="co"># Dale un vistazo a la tabla (View(data)), la última columna es la nueva &quot;log10_dom_abs&quot;, también notarás que, en la pestaña &quot;Environment&quot; de RStudio, ahora el objeto &quot;data&quot; tiene &quot;31 variables&quot;.</span>
<span class="co"># Si deseas tener una vista previa de como quedará tu &quot;data&quot; antes de guardar cualquier cambio, puedes usar pipe para agregar la función head() al final</span>
data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">log10_dom_abs =</span> <span class="kw">log10</span>(dominance_absolute)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">head</span>()</code></pre></div>
<pre><code>## # A tibble: 6 x 31
##   sample_ID geo_loc_name species observed shannon richness_0 richness_20
##   &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1 SRR64426… Estrecho de… Megapt…       31    2.12         31          31
## 2 SRR64426… Estrecho de… Megapt…       33    1.50         33          33
## 3 SRR64426… Estrecho de… Megapt…       43    2.25         43          43
## 4 SRR64427… Estrecho de… Megapt…       29    1.31         29          29
## 5 SRR64427… Estrecho de… Megapt…       26    1.08         26          26
## 6 SRR64427… Estrecho de… Megapt…       21    1.13         21          21
## # … with 24 more variables: richness_50 &lt;dbl&gt;, richness_80 &lt;dbl&gt;,
## #   diversities_inverse_simpson &lt;dbl&gt;, diversities_gini_simpson &lt;dbl&gt;,
## #   diversities_shannon &lt;dbl&gt;, diversities_fisher &lt;dbl&gt;,
## #   diversities_coverage &lt;dbl&gt;, evenness_camargo &lt;dbl&gt;,
## #   evenness_pielou &lt;dbl&gt;, evenness_simpson &lt;dbl&gt;, evenness_evar &lt;dbl&gt;,
## #   evenness_bulla &lt;dbl&gt;, dominance_dbp &lt;dbl&gt;, dominance_dmn &lt;dbl&gt;,
## #   dominance_absolute &lt;dbl&gt;, dominance_relative &lt;dbl&gt;,
## #   dominance_simpson &lt;dbl&gt;, dominance_core_abundance &lt;dbl&gt;,
## #   dominance_gini &lt;dbl&gt;, rarity_log_modulo_skewness &lt;dbl&gt;,
## #   rarity_low_abundance &lt;dbl&gt;, rarity_noncore_abundance &lt;dbl&gt;,
## #   rarity_rare_abundance &lt;dbl&gt;, log10_dom_abs &lt;dbl&gt;</code></pre>
</div>
<div id="dividir---aplicar---combinar" class="section level2">
<h2><span class="header-section-number">2.4</span> Dividir -&gt; aplicar -&gt; combinar</h2>
<p>Varias operaciones de análisis de datos se pueden realizar, primero dividiendo los datos en grupos, segundo aplicando análisis a cada grupo, y tercero combinando los resultados. Hacemos esto usando las funciones <code>group_by()</code> y <code>summarize()</code> juntas. <code>group_by()</code> toma como argumento los nombres de la columna que contiene valores categóricos, a partir de las cuales queremos hacer algún cálculo. <code>summarize()</code> colapsa cada grupo en una única fila.</p>
<ul>
<li>Vamos a calcular el promedio y desviación estándar (<code>mean()</code>; <code>sd()</code>) del número de taxas observadas (columna “observed”) por zona (columna “geo_loc_name”) y especie (columna “species”) de ballena:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(geo_loc_name, species) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># puedes agrupar por una o múltiples columnas</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">mean_observed =</span> <span class="kw">mean</span>(observed), <span class="co"># una vez que los datos están agrupados, también puedes aplicar múltiples análisis al mismo tiempo y en múltiples variables</span>
            <span class="dt">sd_observed =</span> <span class="kw">sd</span>(observed), 
            <span class="dt">mean_shannon =</span> <span class="kw">mean</span>(shannon), 
            <span class="dt">sd_shannon =</span> <span class="kw">sd</span>(shannon))</code></pre></div>
<pre><code>## # A tibble: 5 x 6
## # Groups:   geo_loc_name [3]
##   geo_loc_name   species  mean_observed sd_observed mean_shannon sd_shannon
##   &lt;chr&gt;          &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
## 1 Chiloe         Balaeno…          55.0       19.9          1.57      0.568
## 2 Chiloe         Megapte…          38.5       34.6          1.00      0.385
## 3 Estrecho de M… Megapte…          33.5        7.60         1.42      0.457
## 4 Reserva Nacio… Balaeno…          33.9       22.3          1.34      0.717
## 5 Reserva Nacio… Megapte…          43.3       23.6          1.52      0.564</code></pre>
<ul>
<li>Si lo necesitas, también puedes agregar un filtro antes de agrupar los datos y hacer estadística de los grupos. Por ejemplo, supongamos que decidimos no considerar aquellas muestras con menos de 20 taxas (<code>observed</code> &lt; 20):</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(observed <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(geo_loc_name, species) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">mean_observed_min20 =</span> <span class="kw">mean</span>(observed)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">print</span>() <span class="co"># para ver el resultado (output) en la consola</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
## # Groups:   geo_loc_name [3]
##   geo_loc_name                      species              mean_observed_min…
##   &lt;chr&gt;                             &lt;chr&gt;                             &lt;dbl&gt;
## 1 Chiloe                            Balaenoptera muscul…               59.7
## 2 Chiloe                            Megaptera novaeangl…               63  
## 3 Estrecho de Magallanes            Megaptera novaeangl…               33.5
## 4 Reserva Nacional Pinguino de Hum… Balaenoptera physal…               46.8
## 5 Reserva Nacional Pinguino de Hum… Megaptera novaeangl…               49.2</code></pre>
<ul>
<li>Muchas veces es útil re-organizar los datos para una más eficiente interpretación de los resultados. Por ejemplo, si queremos ordenar los resultados por número promedio de taxa observado por grupo (“mean_observed”) en orden decreciente:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(geo_loc_name, species) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">mean_observed =</span> <span class="kw">mean</span>(observed), 
            <span class="dt">sd_observed =</span> <span class="kw">sd</span>(observed), 
            <span class="dt">mean_shannon =</span> <span class="kw">mean</span>(shannon), 
            <span class="dt">sd_shannon =</span> <span class="kw">sd</span>(shannon)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean_observed)) <span class="co"># la función arrange(), por defecto, ordena los datos en orden creciente, usamos la función desc() para ordenar en orden decreciente</span></code></pre></div>
<pre><code>## # A tibble: 5 x 6
## # Groups:   geo_loc_name [3]
##   geo_loc_name   species  mean_observed sd_observed mean_shannon sd_shannon
##   &lt;chr&gt;          &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
## 1 Chiloe         Balaeno…          55.0       19.9          1.57      0.568
## 2 Reserva Nacio… Megapte…          43.3       23.6          1.52      0.564
## 3 Chiloe         Megapte…          38.5       34.6          1.00      0.385
## 4 Reserva Nacio… Balaeno…          33.9       22.3          1.34      0.717
## 5 Estrecho de M… Megapte…          33.5        7.60         1.42      0.457</code></pre>
</div>
<div id="contar" class="section level2">
<h2><span class="header-section-number">2.5</span> Contar</h2>
<p>La función <code>count()</code> nos permite conocer el número de observaciones por cada variable, o combinación de ellas, en tus datos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">count</span>(species) <span class="co"># ¿cuantas muestras por especie de ballena tenemos?</span>
data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">count</span>(geo_loc_name, <span class="dt">sort =</span> <span class="ot">TRUE</span>) <span class="co"># argumento &quot;sort = TRUE&quot; para ordenar (decreciente)</span>
data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">count</span>(geo_loc_name, species) <span class="co"># ¿cuantas muestras de cada especie tenemos por zona?</span></code></pre></div>
</div>
<div id="remodelar-tablas-usando-spread-y-gather" class="section level2">
<h2><span class="header-section-number">2.6</span> Remodelar tablas usando <code>spread()</code> y <code>gather()</code></h2>
<p>Con el objetivo de explorar las relaciones entre ciertas variables de interés en nuestros datos, podemos remodelar la tabla de datos de acuerdo a éstas variables.</p>
<p>Supongamos que nos interesa explorar la relación entre la diversidad del microbioma de la piel (“shannon”) de las especies de ballena (“species”) y su locación geográfica.</p>
<ul>
<li>Primero, necesitamos usar <code>group_by()</code> y <code>summarize()</code>, para agrupar nuestras variables de interés y crear una nueva columna con los valores de índice de Shannon promedio para cada grupo. Después, usamos la función <code>spread()</code> para transformar <code>data</code> de modo que: cada especie ahora sea una columna, cada locación geográfica ahora sea una fila, y los valores de Shannon estén en cada celda según corresponda.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_spread &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(geo_loc_name, species) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(<span class="dt">mean_shannon =</span> <span class="kw">mean</span>(shannon)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> species, <span class="dt">value =</span> mean_shannon, <span class="dt">fill =</span> <span class="ot">NA</span>)
<span class="kw">head</span>(data_spread)</code></pre></div>
<pre><code>## # A tibble: 3 x 4
## # Groups:   geo_loc_name [3]
##   geo_loc_name       `Balaenoptera mus… `Balaenoptera ph… `Megaptera novae…
##   &lt;chr&gt;                           &lt;dbl&gt;             &lt;dbl&gt;             &lt;dbl&gt;
## 1 Chiloe                           1.57             NA                 1.00
## 2 Estrecho de Magal…              NA                NA                 1.42
## 3 Reserva Nacional …              NA                 1.34              1.52</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Como el número de taxa observada varía por cada muestra, tenemos como resultado varias celdas &quot;NA&quot; (&quot;missing data&quot;). Para éstos casos, la función spread() viene con el argumento &quot;fill&quot;.</span></code></pre></div>
<p>Ahora vamos a suponer la situación contraria. Inicialmente, tenemos una tabla de datos como <code>data_spread</code>, en la que los nombres de las especies (“species”) son columnas, pero en vez de ello, queremos que las especies sean valores de la variable “species” (columna: “species”).</p>
<ul>
<li>Para lograrlo, necesitamos reunir los nombres de las columnas (especies) y convertirlos en un set de variables:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_gather &lt;-<span class="st"> </span>data_spread <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> species, <span class="dt">value =</span> mean_shannon, <span class="op">-</span>geo_loc_name) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(mean_shannon))
<span class="kw">head</span>(data_gather)</code></pre></div>
<pre><code>## # A tibble: 5 x 3
## # Groups:   geo_loc_name [3]
##   geo_loc_name                          species                mean_shannon
##   &lt;chr&gt;                                 &lt;chr&gt;                         &lt;dbl&gt;
## 1 Chiloe                                Balaenoptera musculus          1.57
## 2 Reserva Nacional Pinguino de Humboldt Balaenoptera physalus          1.34
## 3 Chiloe                                Megaptera novaeangliae         1.00
## 4 Estrecho de Magallanes                Megaptera novaeangliae         1.42
## 5 Reserva Nacional Pinguino de Humboldt Megaptera novaeangliae         1.52</code></pre>
<p>La función <code>is.na()</code> determina si un dato es <code>NA</code> (<em>Not Available</em>). El símbolo <code>!</code> niega el el resultado. Por lo tanto, al usar <code>!is.na(mean_shannon)</code> estamos pidiendo por valor que <strong>no</strong> es <code>NA</code> en la columna <code>mean_shannon</code>.</p>
</div>
<div id="exportar-datos" class="section level2">
<h2><span class="header-section-number">2.7</span> Exportar datos</h2>
<p>El trabajo hecho en una sesión de R (e.g., análisis, nuevas tablas, etc.) sólo existe en la memoria de R mientras la sesión esté abierta. Necesitas <strong>exportar</strong> los nuevos datos creados para archivarlos en tu computadora. Entonces, así como existe la función <code>read_csv()</code> para leer archivos CSV (<em>comma-separated values</em>) en R, hay una función para <strong>generar</strong> archivos CSV a partir de tablas de datos en contenidas como <code>objetos</code> en la memoria de R.</p>
<ul>
<li>Por ejemplo, para exportar el <em>data frame</em> que creamos recién usando la función <code>gather()</code> y <code>filter()</code>:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Los argumentos básicos de write_csv() son primero indicar el objeto que se quiere exportar y luego la ruta y nombre del archivo de salida, incluyendo la extensión .csv</span>
<span class="kw">write_csv</span>(data_gather, <span class="dt">path =</span> <span class="st">&quot;data_gather.csv&quot;</span>)</code></pre></div>
</div>
</div>
<div id="visualizacion-de-datos-en-r" class="section level1">
<h1><span class="header-section-number">3</span> Visualización de datos en R</h1>
<p>Para comenzar, primero debemos importar el o los paquetes requeridos. <code>ggplot2</code> está incluido en el paquete <code>tidyverse</code>.</p>
<pre><code>library(tidyverse)</code></pre>
<p>En caso de que la tabla de datos de estudio no esté en la memoria de R, puedes cargarla nuevamente.</p>
<pre><code>data &lt;- read_csv(&quot;IR_table1.csv&quot;)</code></pre>
<p><strong><code>ggplot2</code></strong> es un paquete para graficar, que facilita crear gráficas complejas a partir de datos en un <em>data frame</em>. Incluye varias funciones para especificar que variables graficar, como éstas son expuestas, y varias otras características visuales. <code>ggplot2</code> funciona mejor con datos extensos, i.e., una columna por cada dimensión, y una fila por cada observación. Tener datos bien estructurados te ayudará a crear figuras más eficientemente.</p>
<div id="graficar-con-ggplot2" class="section level2">
<h2><span class="header-section-number">3.1</span> Graficar con <code>ggplot2</code></h2>
<p>Las gráficas de ggplot son construidas paso a paso, agregando nuevos elementos cada vez. Para graficar con ggplot, vamos a usar una línea de comando templado que es útil para diferentes tipos de gráficos:</p>
<pre><code>ggplot(data = , mapping = aes()) + ()</code></pre>
<ul>
<li><p>Usamos la función <code>ggplot()</code> y el argumento <code>data</code> para indicar a partir de qué datos se debe crear la gráfica. Luego, la función <code>aes()</code> (<em>aesthetic</em>) para seleccionar las variables a graficar y como presentarlas, e.g. ejes <em>x</em> e <em>y</em> o características como tamaño, forma, color, etc.</p></li>
<li><p><code>ggplot2</code> ofrece “<strong><code>geoms</code></strong>” para indicar la representación gráfica de los datos (puntos, líneas, barras), algunos de ellos son:</p></li>
<li><code>geom_point()</code> para gráficos de dispersión.</li>
<li><code>geom_boxplot()</code> para gráficos de caja (boxplots).</li>
<li><p><code>geom_line()</code> para líneas de tendencia, series de tiempo, etc.</p></li>
</ul>
<p>Usa <code>+</code> para agregar un <code>geom</code> a línea de comando de <code>ggplot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="kw">aes</span>(<span class="dt">x =</span> shannon, <span class="dt">y =</span> evenness_camargo)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="introR_files/figure-html/ggplot1-1.png" width="672" /></p>
<p><strong>Notas</strong></p>
<ul>
<li>Toda la información o <em>inputs</em> que agregues en la función <code>ggplot()</code> son considerados por cualquier <code>geom</code> (i.e., éstas son configuraciones universales), lo que incluye las variables para el eje <em>x</em> e <em>y</em> indicados usando <code>aes()</code>.</li>
<li>También puedes especificar <em>inputs</em> para un <code>geom</code> dado, independientemente de los definidos en la función <code>ggplot()</code>.</li>
<li>El signo <code>+</code> se usa para añadir nuevas funciones y se usa al final de cada línea que contiene la función anterior.</li>
</ul>
</div>
<div id="construyendo-graficos-iterativamente" class="section level2">
<h2><span class="header-section-number">3.2</span> Construyendo gráficos iterativamente</h2>
<p>Construir gráficos con <code>ggplot2</code> es comúnmente un proceso iterativo. Primero definimos un set de datos a utilizar, luego indicamos las variables a graficar (ejes <em>x</em> e <em>y</em>), y escogemos un <code>geom</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="kw">aes</span>(<span class="dt">x =</span> observed, <span class="dt">y =</span> shannon)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="introR_files/figure-html/ggplot2-1.png" width="672" /></p>
<p>Seguidamente, empezamos a modificar el gráfico para extraer más información de él y hacerlo más explíito o auto-explicativo. Por ejemplo, podemos agregar transparencia (<code>alpha</code>) para evidenciar la sobre-posición de los puntos (<em>overplotting</em>). También podemos colorear los puntos (<code>color</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="kw">aes</span>(<span class="dt">x =</span> observed, <span class="dt">y =</span> shannon)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.4</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="introR_files/figure-html/ggplot3-1.png" width="672" /></p>
<p>Además, es posible “<strong>anotar</strong>” tus datos de acuerdo a cierta(s) variable(s) categórica(s), es decir, colorearlos o asignarles formas según ciertas características que tu consideres influyentes en tus datos. Por ejemplo, vamos a anotar nuestra gráfica por especie (“species”) y por locación geográfica (“geo_loc_name”).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="kw">aes</span>(<span class="dt">x =</span> observed, <span class="dt">y =</span> shannon)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.7</span>, <span class="kw">aes</span>(<span class="dt">color =</span> geo_loc_name, <span class="dt">shape =</span> species))</code></pre></div>
<p><img src="introR_files/figure-html/ggplot4-1.png" width="672" /></p>
</div>
<div id="boxplot" class="section level2">
<h2><span class="header-section-number">3.3</span> Boxplot</h2>
<p><em>Boxplots</em> o gráficos de caja, son útiles para visualizar la distribución de los datos de acuerdo a una variable o condición de interés.</p>
<ul>
<li>Por ejemplo, para visualizar la distribución de número de taxas observadas en el microbioma de la piel de las ballenas muestreadas en Chiloé, Estrecho Magallanes y Parque Nacional Pingüino de Humboldt:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="kw">aes</span>(<span class="dt">x =</span> geo_loc_name, <span class="dt">y =</span> observed)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="introR_files/figure-html/boxplot1-1.png" width="672" /></p>
<ul>
<li>Sin embargo, ¿podría éste resultado estar sesgado por el tamaño muestreal de cada locación geográfica?. Veamos cuántas muestras tenemos por locación geográfica:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">count</span>(geo_loc_name, <span class="dt">sort =</span> <span class="ot">TRUE</span>)</code></pre></div>
<ul>
<li>Agregar puntos al <em>boxplot</em> nos da una mejor idea del número de muestras y su distribución:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="kw">aes</span>(<span class="dt">x =</span> geo_loc_name, <span class="dt">y =</span> observed)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;tomato&quot;</span>)</code></pre></div>
<p><img src="introR_files/figure-html/boxplot2-1.png" width="672" /></p>
<p>¿Notas como las cajas (<em>boxplot layer</em>) están detrás de los puntos (<em>jitter layer</em>)? ¿Qué necesitas cambiar en el código de ggplot para que las cajas aparezcan en frente de los puntos? (<em>Pista: el orden sí importa</em>)</p>
</div>
<div id="graficar-datos-con-series-de-tiempo" class="section level2">
<h2><span class="header-section-number">3.4</span> Graficar datos con series de tiempo</h2>
<p>Cuando tienes datos tomados en una serie de tiempo, una buena manera de visualizarlos es a través de un gráfico de líneas. En el siguiente ejemplo vamos a utilizar una tabla de datos correspondiente a un sub-muestreo de un experimento RNAseq, que contiene las <em>read counts</em> de 8 transcritos después de 0, 3, 6, 12 y 24 horas de exposición a un estímulo X.</p>
<ul>
<li><p>Descarga la tabla de datos <code>VD_table2.tbl</code> <a href="https://www.dropbox.com/s/rlksi77bzep5g2t/VD_table2.tbl?dl=0">AQUÍ</a>.</p></li>
<li><p>Primero vamos a cargar dicha tabla a la memoria de R:</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tr_counts &lt;-<span class="st"> </span><span class="kw">read_table2</span>(<span class="dt">file =</span> <span class="st">&quot;~/Dropbox/CastroLab_database/workshops_data/VD_table2.tbl&quot;</span>, <span class="dt">col_names =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   transcripts = col_character(),
##   `0hrs` = col_double(),
##   `3hrs` = col_double(),
##   `6hrs` = col_double(),
##   `12hrs` = col_double(),
##   `24hrs` = col_double()
## )</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Usamos la función read_table2() para leer el archivo `data/VD_table2.tbl` y asignarlo al nuevo objeto `tr_counts`.</span>
<span class="co"># El argumento col_names = TRUE es para indicar la presencia de títulos o nombres para cada columna.</span>
tr_counts <span class="co"># dale un vistazo a la nueva tabla de datos</span></code></pre></div>
<pre><code>## # A tibble: 8 x 6
##   transcripts  `0hrs` `3hrs` `6hrs` `12hrs` `24hrs`
##   &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 Transcript_1  2.67   24.5   59.2     9.00    14.2
## 2 Transcript_2  0      87.0    5.71    7.61     0  
## 3 Transcript_3  1.84   54.9  131.     63.5     15.6
## 4 Transcript_4  0.256  16.6   27.1     1.33    18.5
## 5 Transcript_5  0       0      0       0        0  
## 6 Transcript_6  0       6.31   0       0        0  
## 7 Transcript_7  0       6.64   0       0        0  
## 8 Transcript_8  0     767.    92.7   141.       0</code></pre>
<p>Generalmente, a través de la metodología de RNAseq, podemos obtener una tabla como <code>tr_counts</code>, que informa de las <em>read counts</em> de cada transcrito por tiempo muestral. Sin embargo, para crear un gráfico lineal, usando <code>ggplot() + geom_line()</code>, en el que el eje <em>X</em> represente una serie de tiempo, es necesario que los tiempos muestreales sean una variable (no nombres de columnas, como en <code>tr_counts</code>).</p>
<ul>
<li>Entonces, recordamos lo aprendido anteriormente y utilizamos la función <code>gather()</code> para <strong>remodelar</strong> <code>tr_counts</code>, reuniendo los nombres de las columnas (tiempos) y transformándolos en un set de variables:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tr_plot &lt;-<span class="st"> </span>tr_counts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> time, <span class="dt">value =</span> read_counts, <span class="op">-</span>transcripts)
<span class="co"># View(tr_plot)</span></code></pre></div>
<ul>
<li>Ahora podemos graficar las <em>read counts</em> de cada transcrito a través de los 5 puntos muestreales, usando <code>ggplot() + geom_line()</code>:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> tr_plot, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> read_counts, <span class="dt">group =</span> transcripts)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="introR_files/figure-html/lineplot1-1.png" width="672" /></p>
<ul>
<li>¿Aún no? Podemos anotar las líneas para identificar cada transcrito:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> tr_plot, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> read_counts, <span class="dt">group =</span> transcripts)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> transcripts))</code></pre></div>
<p><img src="introR_files/figure-html/lineplot2-1.png" width="672" /></p>
<p>Como ya habrás notado, tanto en la gráfica como en la tabla, el rango de los valores de <em>read counts</em> es bastante amplio…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(tr_plot<span class="op">$</span>read_counts) <span class="co"># &#39;objeto$columna&#39;</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(tr_plot<span class="op">$</span>read_counts)</code></pre></div>
<pre><code>## [1] 766.8096</code></pre>
<p>Al graficar, en muchos cachos es conveniente considerar la <strong>escala</strong> de las observaciones, con el fin de obtener una mejor visualización de la distribución de los datos.</p>
<ul>
<li>Vamos a convertir los valores de <em>read counts</em> al logarítmo base 10 de las <em>read counts</em>, de modo de reducir el rango de distribución de los valores. Para ello, modificamos la escala del eje <em>Y</em> usando <code>scale_y_log10()</code>:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> tr_plot, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> read_counts, <span class="dt">group =</span> transcripts)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> transcripts)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_log10</span>()</code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<p><img src="introR_files/figure-html/lineplot3-1.png" width="672" /></p>
<p>¡<strong>Warning message</strong>! Obtenemos un gráfico, pero algo no está bien…</p>
<p>¿A qué crees que se debe el mensaje de advertencia? ¿Qué otro aspecto del gráfico crees tú es necesario modificar?</p>
<ul>
<li>Solución:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> tr_plot, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> <span class="kw">log10</span>(read_counts<span class="op">+</span><span class="dv">1</span>), <span class="dt">group =</span> transcripts)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> transcripts))</code></pre></div>
<p><img src="introR_files/figure-html/lineplot4-1.png" width="672" /></p>
<p>¡<strong>Truco</strong>! Transforma la columna “time” en un factor ordenado, para que ggplot respete el orden deseado de tu serie de tiempo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tr_plot<span class="op">$</span>time &lt;-<span class="st"> </span><span class="kw">factor</span>(tr_plot<span class="op">$</span>time, <span class="dt">levels=</span><span class="kw">unique</span>(tr_plot<span class="op">$</span>time))
<span class="kw">ggplot</span>(<span class="dt">data =</span> tr_plot, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> <span class="kw">log10</span>(read_counts<span class="op">+</span><span class="dv">1</span>), <span class="dt">group =</span> transcripts)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> transcripts))</code></pre></div>
<p><img src="introR_files/figure-html/lineplot5-1.png" width="672" /></p>
</div>
<div id="faceting" class="section level2">
<h2><span class="header-section-number">3.5</span> <em>Faceting</em></h2>
<p><em>Faceting</em> es una propiedad de <code>ggplot</code> que permite dividir un gráfico en múltiples gráficos basado en un factor incluído en el set de datos.</p>
<ul>
<li>Continuando con el gráfico que hemos estado trabajando, usamos <code>facet_wrap()</code> para hacer un gráfico por cada transcrito:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> tr_plot, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> <span class="kw">log10</span>(read_counts<span class="op">+</span><span class="dv">1</span>), <span class="dt">group =</span> transcripts)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> transcripts)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>transcripts)</code></pre></div>
<p><img src="introR_files/figure-html/lineplot6-1.png" width="672" /></p>
</div>
<div id="ggplot2-themes" class="section level2">
<h2><span class="header-section-number">3.6</span> <code>ggplot2</code> <em>themes</em></h2>
<p><strong><em>Themes</em></strong> permite configurar la apariencia o características estéticas de los gráficos creados con <code>ggplot</code>. Puedes revisar la lista completa de <em>themes</em> disponibles <a href="http://ggplot2.tidyverse.org/reference/ggtheme.html">aquí</a>.</p>
<ul>
<li>Por ejemplo, gráficos con fondo blanco lucen mejor cuando son impresos. Podemos hacer que el fondo de las gráficas sea blanco usando la función <code>theme_bw()</code>, también podemos remover la cuadrícula:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> tr_plot, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> <span class="kw">log10</span>(read_counts<span class="op">+</span><span class="dv">1</span>), <span class="dt">group =</span> transcripts)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> transcripts)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>transcripts) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="introR_files/figure-html/lineplot7-1.png" width="672" /></p>
<p>Mientras que, la función <code>facet_wrap()</code> organiza los gráficos en un número arbitrario de filas y columnas, también existe la función <code>facet_grid</code> que permite especificar como organizar los gráficos usando la siguiente nomenclatura: <code>filas ~ columnas</code>, también podemos usar <code>.</code> para indicar sólo una fila o columna (e.g., todas las gráficas en una columna: <code>facet_grid(transcripts ~ .)</code>).</p>
</div>
<div id="personalizacion" class="section level2">
<h2><span class="header-section-number">3.7</span> Personalización</h2>
<p><code>ggplot2</code> cuenta con varias funciones para personalizar gráficas, dale un vistazo al <strong><em><a href="https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf">Cheat Sheet “Data Visualization”</a></em></strong> para pensar en formas de mejorar tus gráficos, también puedes inspirarte buscando ejemplos en internet, como <a href="https://www.r-graph-gallery.com/portfolio/ggplot2-package/">aquí</a>.</p>
<ul>
<li>Vamos a revisar un ejemplo de como personalizar el <em>boxplot</em> que estuvimos trabajando anteriormente:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="kw">aes</span>(<span class="dt">x =</span> geo_loc_name, <span class="dt">y =</span> observed, <span class="dt">color =</span> geo_loc_name)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">85</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">10</span>), 
        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>), 
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), 
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Observed number of taxa&quot;</span>)</code></pre></div>
<p><img src="introR_files/figure-html/boxplot3-1.png" width="672" /></p>
</div>
<div id="organizar-y-exportar-graficos" class="section level2">
<h2><span class="header-section-number">3.8</span> Organizar y exportar gráficos</h2>
<p>Anteriormente usamos <em>faceting</em> para separar un gráfico en múltiples gráficos. Sin embargo, también podemos crear una figura con múltiples gráficos diferentes (i.e., diferentes variables, set de datos, tipo de gráfica). El <strong>paquete <code>gridExtra</code></strong> nos permite combinar gráficos separados en una única figura, usando la función <code>grid.arrange()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="kw">aes</span>(<span class="dt">x =</span> geo_loc_name, <span class="dt">y =</span> observed, <span class="dt">color =</span> geo_loc_name)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">85</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">10</span>), 
        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>), 
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), 
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Observed number of taxa&quot;</span>)

p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="kw">aes</span>(<span class="dt">x =</span> shannon, <span class="dt">y =</span> evenness_camargo, <span class="dt">color =</span> species, <span class="dt">shape =</span> geo_loc_name)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.7</span>, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.0</span>,<span class="fl">3.2</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.005</span>,<span class="fl">0.085</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>), 
        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">10</span>, <span class="dt">r =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), 
        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">9</span>), 
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), 
        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>), 
        <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(), 
        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">02</span>, .<span class="dv">98</span>),
        <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;top&quot;</span>),
        <span class="dt">legend.box.just =</span> <span class="st">&quot;left&quot;</span>,
        <span class="dt">legend.margin =</span> <span class="kw">margin</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Shannon&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Camargo evenness&quot;</span>)

<span class="kw">grid.arrange</span>(p1, p2, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">2.5</span>))</code></pre></div>
<p><img src="introR_files/figure-html/combineplots-1.png" width="672" /></p>
<p>Después de crear tu gráfico o figura, puedes guardarlo en un archivo de formato de preferencia (e.g., png, pdf):</p>
<ul>
<li><p>En <strong>RStudio</strong>, dirígete a la pestaña <code>Plots</code> y haz clic en <code>Export</code> para guardar el gráfico que estés visualizando.</p></li>
<li><p>También puedes usar la función <code>ggsave()</code> para, no solo guardar tus gráficos, sino que también modificar la dimensión y resolución por medio de los argumentos <code>width</code>, <code>height</code> y <code>dpi</code>.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Asigna el gráfico a un &#39;objeto&#39;</span>
plot &lt;-<span class="st"> </span><span class="kw">grid.arrange</span>(p1, p2, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">2.5</span>), <span class="dt">heights =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))
<span class="co"># Exporta la nueva figura en fig_output/</span>
<span class="kw">ggsave</span>(<span class="st">&quot;example_plot.pdf&quot;</span>, plot, <span class="dt">width =</span> <span class="dv">14</span>, <span class="dt">height =</span> <span class="dv">8</span>, <span class="dt">device =</span> <span class="st">&quot;pdf&quot;</span>)</code></pre></div>
<hr />
<p><img src="images/back.png" /> <a href="http://castrolab.org/isme/bienvenida_WorkshopISME.html"><strong>Ir a la página de inicio del curso</strong></a></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": false
});
});
</script>

</body>

</html>
